name: Welcome New Contributors

on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]

jobs:
  welcome:
    name: Welcome message
    runs-on: ubuntu-latest

    steps:
      - name: Welcome first-time contributor
        uses: actions/github-script@v6
        with:
          script: |
            const isFirstIssue = context.payload.action === 'opened' && context.payload.issue;
            const isFirstPR = context.payload.action === 'opened' && context.payload.pull_request;

            let message = '';

            if (isFirstIssue) {
              // Check if this is the user's first issue
              const issues = await github.rest.issues.listForRepo({
                owner: context.repo.owner,
                repo: context.repo.repo,
                creator: context.payload.sender.login,
                state: 'all'
              });

              if (issues.data.length === 1) {
                message = `ğŸ‘‹ Bonjour @${context.payload.sender.login} !

Merci d'avoir ouvert votre premiÃ¨re issue sur **AI Driven Dev** ! ğŸ‰

Quelqu'un de l'Ã©quipe va la regarder prochainement. En attendant :

- ğŸ“– Consultez notre [Guide de contribution](../CONTRIBUTING.md)
- ğŸ’¬ N'hÃ©sitez pas Ã  poser des questions
- ğŸ”” Vous recevrez des notifications sur les mises Ã  jour

Merci de contribuer Ã  amÃ©liorer le projet ! ğŸ™`;

                await github.rest.issues.createComment({
                  issue_number: context.issue.number,
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  body: message
                });
              }
            }

            if (isFirstPR) {
              // Check if this is the user's first PR
              const prs = await github.rest.pulls.list({
                owner: context.repo.owner,
                repo: context.repo.repo,
                state: 'all',
                creator: context.payload.sender.login
              });

              if (prs.data.length === 1) {
                message = `ğŸ‰ FÃ©licitations @${context.payload.sender.login} !

Merci d'avoir ouvert votre **premiÃ¨re Pull Request** sur **AI Driven Dev** ! ğŸš€

**Prochaines Ã©tapes :**

1. âœ… Les checks automatiques vont s'exÃ©cuter
2. ğŸ‘€ Un reviewer va examiner votre code
3. ğŸ’¬ N'hÃ©sitez pas Ã  rÃ©pondre aux commentaires
4. ğŸ”„ Vous pouvez pousser de nouveaux commits si besoin

**Ressources utiles :**
- ğŸ“– [Guide de contribution](../CONTRIBUTING.md)
- âœ… [Checklist PR](../.github/PULL_REQUEST_TEMPLATE.md)
- ğŸ’¡ [Standards de qualitÃ©](../CONTRIBUTING.md#standards-de-qualitÃ©)

Merci de contribuer Ã  rendre l'IA plus accessible aux dÃ©veloppeurs ! ğŸ™

---

*PS : Si vous trouvez ce projet utile, n'oubliez pas de lui donner une â­ !*`;

                await github.rest.issues.createComment({
                  issue_number: context.issue.number,
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  body: message
                });
              }
            }
